dist: trusty
language: node_js
node_js:
- '11'
branches:
  only:
  - master
  - "/^v.*$/"
addons:
  apt:
    packages:
      - xvfb
install:
    - npm install -g xvfb-maybe
before_script:
    - export CHROME_BIN=chromium-browser
    - export DISPLAY=:99.0
    - sh -e /etc/init.d/xvfb start
    - npm install --quiet -g gulp
    - npm install
script:
    - npm run build
    - xvfb-maybe ./node_modules/karma/bin/karma start karma.conf.js --single-run
before_deploy:
    - npm run prerelease
deploy:
  - provider: releases
    skip_cleanup: true
    email: alexander_veit@hms.harvard.edu
    api_key:
      secure: xdFgPSEqDdwXXFHlcRN2JbokfZm9bQAS4y/eLoGy3HCi7VfkNLvKZxRJskquwZ56C6o8GkLY1oY3+0IvWP4Eoc2anZ0WeKOjVQ4Oz0AA0qVv8RGyNfPnfZ+BoNBQ2OoH9SW8Prrd1i7wZKZqsxv5ZShznIqXcfyJNVOspAFUs7bZsYIPjcSAHqv79HZd4bNrDJsbZMvc71KA/z/1ZOBHoHWbNViuRAWKJlipFnvR6IE1xVrLqHr618fBTqNEfU5MjIKWb1mlxLq1KyeRqudny7zmAjtoXHXV2nt+OX5Va0OXrbXScibpTNzHggVnDQwzR+NIZX5k/UUJtwaG2zF5y1KZygK1GKmozZ2zzHTAUDL0lC2aClbq4QH2GSI3ZcMhIVUKqPfxIEF7nVXrytRGhuQMX8k+5sr77B1YtcjnWdrED5FQwfOfEXTLRfe5oOGis0427TL865gBjAqdixGPDQVn3qeJ4YkUJkq+J5PsGKRcMLR/uXsoxDdL8SKlKJcHektycVRUfNH5UMMGsUKRdHpcEedA0eAnmmuTTYhKn8u83HzcWsWVa6x5My//iTuZ6y4bhWcOzINbpN+QCBZJhMAhKNEiUXy5PVCTytA942B8UFvj4wSzVpw/WHxy362tZ/Soagj82S0y0TL+/idi9e0v/1SuTXB8EHZ26Gih1i0=
    file: dist.zip
    on:
      tags: true
      branch: master
      repo: higlass/higlass-clinvar
  - provider: npm
    skip_cleanup: true
    email: alexander_veit@hms.harvard.edu
    api_key:
      secure: uEzhhTiqWBpEmF7WPkSdxnUkeEsILQx5vtfrXFYZUUwrZYAXJlgtaNWeu8kiGFpYj09if2YMBfujf5ImF8/9YwMb8UIN9kS8cZFsXE00ptyf+hmMRD2SEkPXgZxnOEZ1/r+FduxnjzTj+ff35oot4q4JRi73kcw+ru/T4DfGFeWHojxu3Ta8me4+kxwKldxnAzJ+gSjAB6xHyoLbT7SbxiRQ719JTxOKakUJRf5gQbXBMYW0Q/KiiGOjq58UxHaD5y7sOWjF5ar+KEYH0aK4m7c7zJObSmYoeVnkgA2eOohufneaYS/SRgPV63UI7yx7ltwEbXwQ4BbX/RDMEaPtUytpzCjpGkM56om4uDuQkKP4uSYrJhF4/WXvjE1i9uKvVGW7MjaNmBrp4LV1tRphiTPhjEPOYvzfUT6NaCp9UsKw4EeTCDDHm2MqPUler5j6Wjf9JwnONKtwIVlEVUr0UUj/pH4CakDVXp+m0ebX60QV8+8+3DYteGTAUT1VBf/mfT3sdd2XFhfiODpAwBsecfHYBG/vBGRvuWZLQyToEqRbx/gayghgkpmPik9js/XKb03g1prkk1ZIfzGFRqiaUd/xMb3oAx9aZI/7Fe5/QZVMRBUo8Pi7Ayt4vY3SjTSzS+TetxJtWV8asy/Mg0p8jgNAIa3lGwKHQcwyp19fBgk=
    on:
      tags: true
      branch: master
      repo: higlass/higlass-clinvar
